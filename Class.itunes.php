<?php

////// Constants for Audio Books
   
define("ALL_CATEGORIES", "");
define("ARTS_AND_ENTERTAINMENT", 50000041);
define("AUDIOBOOKS_LATINO", 50000070);
define("BIOGRAPHY_AND_MEMOIR", 50000042);
define("BUSINESS", 50000043);
define("CLASSICS", 50000045);
define("COMEDY", 50000046);
define("DRAMA_AND_POETRY", 50000047);
define("FICTION", 50000040);
define("HISTORY", 50000049);
define("KIDS_AND_YOUNG_ADULTS", 50000044);
define("LANGUAGES", 50000050);
define("MYSTERY", 50000051);
define("NEWS", 74);
define("NONFICTION", 50000052);
define("RELIGION_AND_SPIRITUALITY", 50000053);
define("ROMANCE", 50000069);
define("SCI_FI_AND_FANTASY", 50000055);
define("SCIENCE", 50000054);
define("SELF_DEVELOPMENT", 50000056);
define("SHOWS_AND_PERIODICALS", 75);
define("SPEAKERS_AND_STORYTELLERS", 50000048);
define("SPORTS", 50000057);
define("TECHNOLOGY", 50000058);
define("TRAVEL_AND_ADVENTURE", 50000059);

////// End of Constants for Audio Books

///// Constants for Books

define("TOP_PAID_BOOKS", "toppaidebooks");
define("TOP_FREE_BOOKS", "topfreeebooks");
define('EBOOKS_ALL', "");
define('EBOOKS_ARTS_AND_ENTERTAINMENT', 9007);
define('EBOOKS_BIOGRAPHIES_AND_MEMOIRS', 9008);
define('EBOOKS_BUSINESS_AND_PERSONAL_FINANCE', 9009);
define('EBOOKS_CHILDREN_AND_TEENS', 9010);
define('EBOOKS_COMICS_AND_GRAPHIC_NOVELS', 9026);
define('EBOOKS_COMPUTERS_AND_INTERNET', 9027);
define('EBOOKS_COOKBOOKS_FOOD_AND_WINE', 9028);
define('EBOOKS_FICTION_AND_LITERATURE', 9031);
define('EBOOKS_HEALTH, MIND_AND_BODY', 9025);
define('EBOOKS_HISTORY', 9015);
define('EBOOKS_HUMOR', 9012);
define('EBOOKS_LIFESTYLE_AND_HOME', 9024);
define('EBOOKS_MYSTERIES_AND_THRILLERS', 9032);
define('EBOOKS_NONFICTION', 9002);
define('EBOOKS_PARENTING', 9030);
define('EBOOKS_POLITICS_AND_CURRENT_EVENTS', 9034);
define('EBOOKS_PROFESSIONAL_AND_TECHNICAL', 9029);
define('EBOOKS_REFERENCE', 9033);
define('EBOOKS_ROMANCE', 9003);
define('EBOOKS_SCI-FI_AND_FANTASY', 9020);
define('EBOOKS_SCIENCE_AND_NATURE', 9019);
define('EBOOKS_SPORTS_AND_OUTDOORS', 9035);
define('EBOOKS_TRAVEL_AND_ADVENTURE', 9004);

///// End of Constants for Books

//// Constants for IOS Apps

/// Constants for Ranking argument
define('IOS_APPS_TOP_FREE','topfreeapplications');
define('IOS_APPS_TOP_PAID','toppaidapplications');
define('IOS_APPS_TOP_GROSSING','topgrossingapplications');
define('IOS_APPS_TOP_FREE_IPAD','topfreeipadapplications');
define('IOS_APPS_TOP_GROSSING_IPAD','topgrossingipadapplications');
define('IOS_APPS_NEW','newapplications');
define('IOS_APPS_NEW_FREE','newfreeapplications');
define('IOS_APPS_NEW_PAID','newpaidapplications');
/// End of Constants for Ranking argument

define('IOS_APPS_ALL', "");
define('IOS_APPS_BOOKS', 6018);
define('IOS_APPS_BUSINESS', 6000);
define('IOS_APPS_CATALOGS', 6022);
define('IOS_APPS_EDUCATION', 6017);
define('IOS_APPS_ENTERTAINMENT', 6016);
define('IOS_APPS_FINANCE', 6015);
define('IOS_APPS_FOOD_AND_DRINK', 6023);
define('IOS_APPS_GAMES', 6014);
define('IOS_APPS_HEALTH_AND_FITNESS', 6013);
define('IOS_APPS_LIFESTYLE', 6012);
define('IOS_APPS_MEDICAL', 6020);
define('IOS_APPS_MUSIC', 6011);
define('IOS_APPS_NAVIGATION', 6010);
define('IOS_APPS_NEWS', 6009);
define('IOS_APPS_NEWSSTAND', 6021);
define('IOS_APPS_PHOTO_AND_VIDEO', 6008);
define('IOS_APPS_PRODUCTIVITY', 6007);
define('IOS_APPS_REFERENCE', 6006);
define('IOS_APPS_SOCIAL_NETWORKING', 6005);
define('IOS_APPS_SPORTS', 6004);
define('IOS_APPS_TRAVEL', 6003);
define('IOS_APPS_UTILITIES', 6002);
define('IOS_APPS_WEATHER', 6001);

//// End of constants for IOS Apps

//// Constants for Mac Apps

/// Constants for Ranking argument
define('TOP_MAC_APPS','topmacapps');
define('TOP_MAC_APPS_FREE','topfreemacapps');
define('TOP_MAC_APPS_GROSSING','topgrossingmacapps');
define('TOP_MAC_APPS_PAID','toppaidmacapps');

/// End of Constants for Ranking argument

define('MAC_ALL', "");
define('MAC_BUSINESS', 12001);
define('MAC_DEVELOPER_TOOLS', 12002);
define('MAC_EDUCATION', 12003);
define('MAC_ENTERTAINMENT', 12004);
define('MAC_FINANCE', 12005);
define('MAC_GAMES', 12006);
define('MAC_GRAPHICS_AND_DESIGN', 12022);
define('MAC_HEALTH_AND_FITNESS', 12007);
define('MAC_LIFESTYLE', 12008);
define('MAC_MEDICAL', 12010);
define('MAC_MUSIC', 12011);
define('MAC_NEWS', 12012);
define('MAC_PHOTOGRAPHY', 12013);
define('MAC_PRODUCTIVITY', 12014);
define('MAC_REFERENCE', 12015);
define('MAC_SOCIAL_NETWORKING', 12016);
define('MAC_SPORTS', 12017);
define('MAC_TRAVEL', 12018);
define('MAC_UTILITIES', 12019);
define('MAC_VIDEO', 12020);
define('MAC_WEATHER', 12021);

//// End of Constants for Mac Apps

/// Constants for Movies

/// Constants for Ranking argument

define('TOP_MOVIES','topmovies');
define('TOP_VIDEO_RENTALS','topvideorentals');

/// End of Constants for Ranking argument

define('MOVIES_ALL', "");
define('MOVIES_ACTION_AND_ADVENTURE', 4401);
define('MOVIES_CLASSICS', 4403);
define('MOVIES_COMEDY', 4404);
define('MOVIES_DOCUMENTARY', 4405);
define('MOVIES_DRAMA', 4406);
define('MOVIES_FOREIGN', 4407);
define('MOVIES_HORROR', 4408);
define('MOVIES_INDEPENDENT', 4409);
define('MOVIES_KIDS_AND_FAMILY', 4410);
define('MOVIES_ROMANCE', 4412);
define('MOVIES_SCI-FI_AND_FANTASY', 4413);
define('MOVIES_SHORT_FILMS', 4414);
define('MOVIES_SPORTS', 4417);
define('MOVIES_THRILLER', 4416);
define('MOVIES_WESTERN', 4418);

/// End of contstants for movies

/// Constants for Music

/// Constants for Ranking argument

define('MUSIC_TOP_ALBUMS','topalbums');
define('MUSIC_TOP_MIXES','topimixes');
define('MUSIC_TOP_SONGS','topsongs');
define('MUSIC_NEW_RELEASES','newreleases');
define('MUSIC_JUST_ADDED','justadded');
define('MUSIC_FEATURED_ALBUMS','featuredalbums');

/// End of Constants for Ranking argument
define('MUSIC_TYPE_ALL', "");
define('MUSIC_TYPE_ALTERNATIVE', 20);
define('MUSIC_TYPE_BLUES', 2);
define('MUSIC_TYPE_CHILDREN\'S MUSIC', 4);
define('MUSIC_TYPE_CHRISTIAN_AND_GOSPEL', 22);
define('MUSIC_TYPE_CLASSICAL', 5);
define('MUSIC_TYPE_COMEDY', 3);
define('MUSIC_TYPE_COUNTRY', 6);
define('MUSIC_TYPE_DANCE', 17);
define('MUSIC_TYPE_ELECTRONIC', 7);
define('MUSIC_TYPE_FITNESS_AND_WORKOUT', 50);
define('MUSIC_TYPE_HIP-HOP/RAP', 18);
define('MUSIC_TYPE_HOLIDAY', 8);
define('MUSIC_TYPE_JAZZ', 11);
define('MUSIC_TYPE_LATINO', 12);
define('MUSIC_TYPE_POP', 14);
define('MUSIC_TYPE_R&B/SOUL', 15);
define('MUSIC_TYPE_REGGAE', 24);
define('MUSIC_TYPE_ROCK', 21);
define('MUSIC_TYPE_SINGER/SONGWRITER', 10);
define('MUSIC_TYPE_SOUNDTRACK', 16);
define('MUSIC_TYPE_SPOKEN_WORD', 50000061);
define('MUSIC_TYPE_WORLD', 19);

/// End of Constants for Music

/// Constants for Music Videos

/// Constants for Ranking argument

define('TOP_MUSIC_VIDEOS','topmusicvideos');

/// End of Constants for Ranking argument

define('MUSIC_VIDEOS_ALL', "");
define('MUSIC_VIDEOS_ALTERNATIVE', 1620);
define('MUSIC_VIDEOS_COUNTRY', 1606);
define('MUSIC_VIDEOS_ELECTRONIC', 1607);
define('MUSIC_VIDEOS_LATIN', 1612);
define('MUSIC_VIDEOS_POP', 1614);
define('MUSIC_VIDEOS_R_B_SOUL', 1615);
define('MUSIC_VIDEOS_ROCK', 1621);

/// End of constants for Music Videos

/// Constants for Podcasts

/// Constants for Ranking argument

define('TOP_PODCASTS','toppodcasts');

/// End of Constants for Ranking argument

define('PODCASTS_ALL', "");
define('PODCASTS_ARTS', 1301);
define('PODCASTS_BUSINESS', 1321);
define('PODCASTS_COMEDY', 1303);
define('PODCASTS_EDUCATION', 1304);
define('PODCASTS_GAMES_AND_HOBBIES', 1323);
define('PODCASTS_GOVERNMENT_AND_ORGANIZATIONS', 1325);
define('PODCASTS_HEALTH', 1307);
define('PODCASTS_KIDS_AND_FAMILY', 1305);
define('PODCASTS_MUSIC', 1310);
define('PODCASTS_NEWS_AND_POLITICS', 1311);
define('PODCASTS_RELIGION_AND_SPIRITUALITY', 1314);
define('PODCASTS_SCIENCE_AND_MEDICINE', 1315);
define('PODCASTS_SOCIETY_AND_CULTURE', 1324);
define('PODCASTS_SPORTS_AND_RECREATION', 1316);
define('PODCASTS_TECHNOLOGY', 1318);
define('PODCASTS_TV_AND_FILM', 1309);

/// End of constants for Podcasts

/// Constants for TV Shows

/// Constants for Ranking argument

define('TOP_TV_EPISODES','toptvepisodes');
define('TOP_TV_SEASONS','toptvseasons');

/// End of Constants for Ranking argument

define('TV_SHOWS_ALL', "");
define('TV_SHOWS_ANIMATION', 4002);
define('TV_SHOWS_CLASSIC', 4004);
define('TV_SHOWS_COMEDY', 4000);
define('TV_SHOWS_DRAMA', 4001);
define('TV_SHOWS_KIDS', 4005);
define('TV_SHOWS_NONFICTION', 4006);
define('TV_SHOWS_REALITY_TV', 4007);
define('TV_SHOWS_SCI-FI_AND_FANTASY', 4008);
define('TV_SHOWS_SPORTS', 4009);
define('TV_SHOWS_TEENS', 4010);

/// End of constants for Podcasts


Class iTunes_Connect {
	
	private $itunes_search_url;
	
	private $rss_feed_url;
	
	private $lookup_url;
	
	private $appreviews_url;
	
	private $audiobooks_url;
	
	private $ebooksbooks_url;
	
	private $iphoneapps_url;
	
	private $macapps_url;
	
	private $movies_url;
	
	private $music_url;
	
	private $music_videos_url;
	
	private $podcasts_url;
	
	private $tvshows_url;
	
	function __construct() {
		
		$this->itunes_search_url 	= "https://itunes.apple.com/search";
		$this->rss_feed_url			= "https://itunes.apple.com";
		$this->lookup_url 			= "http://itunes.apple.com/";
		$this->appreviews_url 		= "http://itunes.apple.com/";
		$this->audiobooks_url 		= "https://itunes.apple.com/";
		$this->ebooksbooks_url 		= "https://itunes.apple.com/";
		$this->iphoneapps_url       = "https://itunes.apple.com/";
		$this->macapps_url  		= "https://itunes.apple.com/";      
		$this->movies_url  			= "https://itunes.apple.com/";
		$this->music_url  			= "https://itunes.apple.com/";
		$this->music_videos_url  	= "https://itunes.apple.com/";
		$this->podcasts_url 		= "https://itunes.apple.com/";
		$this->tvshows_url 		= "https://itunes.apple.com/";
		
	}
	
	/**
     * Search for the specified item on the apple iTunes
     *
     * @param Keyword $keyword     // Text string you want to search for
     *
     * @param Country $country     // Complete list of supported countries can be found at http://en.wikipedia.org/wiki/ISO_3166-1_alpha-2
     *
     * @param Language $language   // The language you want to use when results are returned from iTunes.
     * 							   // Specify the language using the five-letter codename. For example: en_us 
     *                               
     * @param Media Type $media    // The media type you want to search for. For example: movie 
     * 							   // Following media types are supported movie, podcast, music, musicVideo, 
     * 								  audiobook, shortFilm, tvShow, software, ebook, all
     * 
     * @param Entity $entity       // The type of results you want returned, relative to the specified media type.
     *                             // Possible values can be seen here 
     *                             // http://www.apple.com/itunes/affiliates/resources/documentation/itunes-store-web-service-search-api.html
     * 
     * @param Limit $limit         // The number of search results you want to get e.g. 10 Min = 1 and Max = 200
     */
	
	function searchiTunes ($keyword , $country = NULL, $language = NULL, $media = NULL, $entity = NULL,  $limit = NULL) {
		
		if(is_null($country)) {
			$country = "US";
		}
		if(is_null($language)) {
			$language = "en_us";
		}
		if(is_null($media)) {
			$media = "all";
		}
		if(is_null($limit)) {
			$limit = 10;
		}
		if(is_null($entity)) {
			$entity = "musicTrack";
		}

		$getdataurl = $this->itunes_search_url;
		$getdataurl.="?term=".urlencode($keyword)."&country=".$country."&lang=".$language."&media=".$media."&entity=".$entity."&limit=".$limit;
		$content = $this->getUrlData($getdataurl);
		$data =  $this->parseiTunesSearchResults($content);
		return $data;
	}
	
	private function parseiTunesSearchResults($data) {
		
		$response = json_decode($data);
		$data = array();
		
		foreach ($response->results as $result) {
			
			$detailedarray = array();
			$detailedarray['artistname']        = $result->artistName;
			$detailedarray['trackname']         = $result->trackName;
			$detailedarray['artistviewurl']     = $result->artistViewUrl;
			$detailedarray['trackurl'] 			= $result->trackViewUrl;
			$detailedarray['trackprice'] 		= $result->trackPrice;
			$detailedarray['currency'] 			= $result->currency;
			
			if(isset($result->collectionName)) {
			
				$detailedarray['albumname'] = $result->collectionName;
			}
			else {
				$detailedarray['albumname'] = "";
			}
			
			if(isset($result->artworkUrl30)) {
				
				$detailedarray['smallimage'] = $result->artworkUrl30;
			}
			else {
				$detailedarray['smallimage'] = "";
			}
			
			if(isset($result->artworkUrl60)) {
			
				$detailedarray['mediumimage'] = $result->artworkUrl60;
			}
			else {
				$detailedarray['mediumimage'] = "";
			}
			
			if(isset($result->artworkUrl10)) {
			
				$detailedarray['largeimage'] = $result->artworkUrl10;
			}
			else {
				$detailedarray['largeimage'] = "";
			}
			
			array_push($data, $detailedarray);
			
		}
		
		return $data;
	}
	
	/**
	 * Get application details from iTunes
	 * 
	 * @param Application ID/ Apple ID $appid     // Application id to get details for
	 * 
	 * @param Country $country     // If you want to get datas from a particular country. 
	 * 							   // Complete list of supported countries can be found at http://en.wikipedia.org/wiki/ISO_3166-1_alpha-2
	 */
	
	function getAppDetails($appid="400274934",$country="US") {
		
		$lookupurl = $this->lookup_url.$country."/lookup?id=" .$appid;
		$appdata = $this->getUrlData($lookupurl);
		$data =  $this->parseApplicationData($appdata);
		return $data;
		
	}
	
	private function parseApplicationData($data) {
		
		$response = json_decode($data);
		$data = array();
		
		foreach ($response->results as $result) {
			
			$data['appname'] 		= $result->trackName;
			$data['version']		= $result->version;
			$data['appicon'] 		= $result->artworkUrl60;
			$data['sellername'] 	= $result->sellerName;
			$data['sellerurl'] 		= $result->sellerUrl;
			$data['appurl']			= $result->trackViewUrl;
			$data['apppricel']		= $result->formattedPrice;
			$data['category'] 		= $result->primaryGenreName;
			$data['releasedata'] 	= date("D d M Y",strtotime($result->releaseDate));
			$data['description'] 	= $result->description;
			$data['userrating'] 	= $result->averageUserRating;
			$data['releasenotes'] 	= $result->releaseNotes;	
		}
		
		return $data;	
	}
	
	/**
	 * Get application reviews from iTunes
	 *
	 * @param Application ID/ Apple ID $appid     // Application id to get details for
	 *
	 * @param Country $country     // If you want to get datas from a particular country.
	 * 							   // Complete list of supported countries can be found at http://en.wikipedia.org/wiki/ISO_3166-1_alpha-2
	 */
	
	function getAppReviews($appid="400274934",$country="US") {
		
		$reviewurl = $this->appreviews_url.$country."/rss/customerreviews/id=" .$appid."/json";
		$appdata = $this->getUrlData($reviewurl);
		$data =  $this->parseApplicationReviewData($appdata);
		return $data;
		
	}
	
	private function parseApplicationReviewData($data) {
		
		$response = json_decode($data);
		$data = array();
		$index = 0;
		
		foreach ($response->feed->entry as $result) {

			$detailedarray = array();
			
			/// It is first entry so get application data
			if($index==0) {
				
				$data['appname'] =  $result->{"im:name"}->label;
				$data['price']   =  $result->{"im:price"}->label;
				$data['image']   =  $result->{"im:image"}[0]->label;
				$data['url']   =  $result->link->attributes->href;
				$data['category'] = $result->category->attributes->label;
			}
			else {
				
				$detailedarray['reviewtitle'] = $result->title->label;
				$detailedarray['reviewdetail'] = $result->content->label;
				$data['reviews'][] = $detailedarray;
				
			}

			$index++;	
		}
		
		return $data;	
	}
	
	
	/**
	 * Get audio books list from apple iTunes
	 *
	 *	@param Country $country     // Complete list of supported countries can be found at http://en.wikipedia.org/wiki/ISO_3166-1_alpha-2
	 * 
	 *	@param Category $category     // All possible categories defined in Constants above
	 *
	 *  @param Limit $limit         // The number of search results you want to get e.g. 10 Min = 1 and Max = 200
	 */
	
	function getAudioBooks($country = NULL, $category = NULL, $limit = NULL) {
		
		$categoryurl = "";
		
		if(is_null($country)) {
			$country = "us";
		}
		
		if(is_null($category)) {
			$category = ALL_CATEGORIES;
		}
		
		if(is_null($limit)) {
			$limit = 10;
		}
		
		if($category!=ALL_CATEGORIES) {
			
			$categoryurl = "/genre=".$category;
		}
		
		$audiobooksurl = $this->audiobooks_url.$country."/rss/topaudiobooks/limit=".$limit.$categoryurl."/json";
		$appdata = $this->getUrlData($audiobooksurl);
		$data = $this->parseRssFeedData($appdata,"audiobooks");
		
		return $data;

	}
	
	/**
	 * Get Ebooks books list from apple iTunes
	 *
	 *	@param Country $country     // Complete list of supported countries can be found at http://en.wikipedia.org/wiki/ISO_3166-1_alpha-2
	 *
	 *	@param Book Ranking $bookranking     // All possible values defined in Constants above
	 *
	 *  @param Category $category         // All possible values defined in Constants above
	 *  
	 *  @param Limit  $limit           // Numbers of records to be pulled 
	 */
	
	function getEBooks($country = NULL, $bookranking = NULL, $category = NULL, $limit = NULL) {
		
		$categoryurl = "";
		
		if(is_null($country)) {
			$country = "us";
		}
		if(is_null($bookranking)) {
			$bookranking = TOP_PAID_BOOKS;
		}
		if(is_null($category)) {
			$category = EBOOKS_ALL;
		}
		if(is_null($limit)) {
			$limit = 10;
		}
		if($category!=EBOOKS_ALL) {
		
			$categoryurl = "/genre=".$category;
		}
		
		$ebooksbooksurl = $this->ebooksbooks_url.$country."/rss/$bookranking/limit=".$limit.$categoryurl."/json";
		$appdata = $this->getUrlData($ebooksbooksurl);
		$data = $this->parseRssFeedData($appdata,"ebooks");
		
		return $data;
		
		
	}
	
	/**
	 * Get iPhones Apps list from apple iTunes
	 *
	 *	@param Country $country     // Complete list of supported countries can be found at http://en.wikipedia.org/wiki/ISO_3166-1_alpha-2
	 *
	 *	@param App Ranking $appsranking     // All possible values defined in Constants above
	 *
	 *  @param Category $category         // All possible values defined in Constants above
	 *
	 *  @param Limit  $limit           // Numbers of records to be pulled
	 */
	
	function getIosApps($country = NULL, $appsranking = NULL, $category = NULL, $limit = NULL) {
		
		$categoryurl = "";
		
		if(is_null($country)) {
			$country = "us";
		}
		if(is_null($appsranking)) {
			$appsranking = IOS_APPS_TOP_FREE;
		}
		if(is_null($category)) {
			$category = IOS_APPS_ALL;
		}
		if(is_null($limit)) {
			$limit = 10;
		}
		if($category!=IOS_APPS_ALL) {
		
			$categoryurl = "/genre=".$category;
		}
		
		$iosappsurl = $this->iphoneapps_url.$country."/rss/$appsranking/limit=".$limit.$categoryurl."/json";
		$appdata = $this->getUrlData($iosappsurl);
		$data = $this->parseRssFeedData($appdata,"iosapps");
		
		return $data;		
	}
	
	/**
	 * Get MAC OSX Apps list from apple iTunes
	 *
	 *	@param Country $country     // Complete list of supported countries can be found at http://en.wikipedia.org/wiki/ISO_3166-1_alpha-2
	 *
	 *	@param App Ranking $appsranking     // All possible values defined in Constants above
	 *
	 *  @param Category $category         // All possible values defined in Constants above
	 *
	 *  @param Limit  $limit           // Numbers of records to be pulled
	 */
	
	
	function getMacApps($country = NULL, $appsranking = NULL, $category = NULL, $limit = NULL) {
		
		$categoryurl = "";
		
		if(is_null($country)) {
			$country = "us";
		}
		if(is_null($appsranking)) {
			$appsranking = TOP_MAC_APPS;
		}
		if(is_null($category)) {
			$category = MAC_ALL;
		}
		if(is_null($limit)) {
			$limit = 10;
		}
		if($category!=MAC_ALL) {
		
			$categoryurl = "/genre=".$category;
		}
		
		$macappsurl = $this->macapps_url.$country."/rss/$appsranking/limit=".$limit.$categoryurl."/json";
		$appdata = $this->getUrlData($macappsurl);
		$data = $this->parseRssFeedData($appdata,"macapps");
		
		return $data;
		
	}
	
	/**
	 * Get Movies list from apple iTunes
	 *
	 *	@param Country $country     // Complete list of supported countries can be found at http://en.wikipedia.org/wiki/ISO_3166-1_alpha-2
	 *
	 *	@param App Ranking $appsranking     // All possible values defined in Constants above
	 *
	 *  @param Category $category         // All possible values defined in Constants above
	 *
	 *  @param Limit  $limit           // Numbers of records to be pulled
	 */
	
	function getMovies($country = NULL, $appsranking = NULL, $category = NULL, $limit = NULL) {
		
		$categoryurl = "";
		
		if(is_null($country)) {
			$country = "us";
		}
		if(is_null($appsranking)) {
			$appsranking = TOP_MOVIES;
		}
		if(is_null($category)) {
			$category = MOVIES_ALL;
		}
		if(is_null($limit)) {
			$limit = 10;
		}
		if($category!=MOVIES_ALL) {
		
			$categoryurl = "/genre=".$category;
		}
		
		$moviesurl = $this->movies_url.$country."/rss/$appsranking/limit=".$limit.$categoryurl."/json";
		$appdata = $this->getUrlData($moviesurl);
		$data = $this->parseRssFeedData($appdata,"movies");
		
		return $data;
	}
	
	/**
	 * Get Audio Songs list from apple iTunes
	 *
	 *	@param Country $country     // Complete list of supported countries can be found at http://en.wikipedia.org/wiki/ISO_3166-1_alpha-2
	 *
	 *	@param App Ranking $appsranking     // All possible values defined in Constants above
	 *
	 *  @param Category $category         // All possible values defined in Constants above
	 *
	 *  @param Limit  $limit           // Numbers of records to be pulled
	 */
	
	function getMusic($country = NULL, $appsranking = NULL, $category = NULL, $limit = NULL) {
		
		$categoryurl = "";
		
		if(is_null($country)) {
			$country = "us";
		}
		if(is_null($appsranking)) {
			$appsranking = MUSIC_TOP_SONGS;
		}
		if(is_null($category)) {
			$category = MUSIC_TYPE_ALL;
		}
		if(is_null($limit)) {
			$limit = 10;
		}
		if($category!=MUSIC_TYPE_ALL) {
		
			$categoryurl = "/genre=".$category;
		}
		
		$moviesurl = $this->music_url.$country."/rss/$appsranking/limit=".$limit.$categoryurl."/json";
		$appdata = $this->getUrlData($moviesurl);
		$data = $this->parseRssFeedData($appdata,"music");
		
		return $data;
	}
	
	/**
	 * Get Video Songs list from apple iTunes
	 *
	 *	@param Country $country     // Complete list of supported countries can be found at http://en.wikipedia.org/wiki/ISO_3166-1_alpha-2
	 *
	 *	@param App Ranking $appsranking     // All possible values defined in Constants above
	 *
	 *  @param Category $category         // All possible values defined in Constants above
	 *
	 *  @param Limit  $limit           // Numbers of records to be pulled
	 */
	
	function getMusicVideos($country = NULL, $appsranking = NULL, $category = NULL, $limit = NULL) {
	
		$categoryurl = "";
	
		if(is_null($country)) {
			$country = "us";
		}
		if(is_null($appsranking)) {
			$appsranking = TOP_MUSIC_VIDEOS;
		}
		if(is_null($category)) {
			$category = MUSIC_VIDEOS_ALL;
		}
		if(is_null($limit)) {
			$limit = 10;
		}
		if($category!=MUSIC_VIDEOS_ALL) {
	
			$categoryurl = "/genre=".$category;
		}
	
		$musicvideosurl = $this->music_videos_url.$country."/rss/$appsranking/limit=".$limit.$categoryurl."/json";
		$appdata = $this->getUrlData($musicvideosurl);
		$data = $this->parseRssFeedData($appdata,"musicvideos");
	
		return $data;
	}
	
	/**
	 * Get PodCasts list from apple iTunes
	 *
	 *	@param Country $country     // Complete list of supported countries can be found at http://en.wikipedia.org/wiki/ISO_3166-1_alpha-2
	 *
	 *	@param App Ranking $appsranking     // All possible values defined in Constants above
	 *
	 *  @param Category $category         // All possible values defined in Constants above
	 *
	 *  @param Limit  $limit           // Numbers of records to be pulled
	 */
	
	function getPodCasts($country = NULL, $appsranking = NULL, $category = NULL, $limit = NULL) {
		
		$categoryurl = "";
		
		if(is_null($country)) {
			$country = "us";
		}
		if(is_null($appsranking)) {
			$appsranking = TOP_PODCASTS;
		}
		if(is_null($category)) {
			$category = PODCASTS_ALL;
		}
		if(is_null($limit)) {
			$limit = 10;
		}
		if($category!=PODCASTS_ALL) {
		
			$categoryurl = "/genre=".$category;
		}
		
		$podcastsurl = $this->podcasts_url.$country."/rss/$appsranking/limit=".$limit.$categoryurl."/json";
		$appdata = $this->getUrlData($podcastsurl);
		$data = $this->parseRssFeedData($appdata,"podcasts");
		
		return $data;
	}
	
	/**
	 * Get TV Shows list from apple iTunes
	 *
	 *	@param Country $country     // Complete list of supported countries can be found at http://en.wikipedia.org/wiki/ISO_3166-1_alpha-2
	 *
	 *	@param App Ranking $appsranking     // All possible values defined in Constants above
	 *
	 *  @param Category $category         // All possible values defined in Constants above
	 *
	 *  @param Limit  $limit           // Numbers of records to be pulled
	 */
	
	function getTvShows ($country = NULL, $appsranking = NULL, $category = NULL, $limit = NULL) {
		
		$categoryurl = "";
		
		if(is_null($country)) {
			$country = "us";
		}
		if(is_null($appsranking)) {
			$appsranking = TOP_TV_EPISODES;
		}
		if(is_null($category)) {
			$category = TV_SHOWS_ALL;
		}
		if(is_null($limit)) {
			$limit = 10;
		}
		if($category!=TV_SHOWS_ALL) {
		
			$categoryurl = "/genre=".$category;
		}
		
		$tvshowsurl = $this->tvshows_url.$country."/rss/$appsranking/limit=".$limit.$categoryurl."/json";
		$appdata = $this->getUrlData($tvshowsurl);
		$data = $this->parseRssFeedData($appdata,"tvshows");
		
		return $data;
	}
	
	private function parseRssFeedData($data,$category) {
		
		$response = json_decode($data);
		$data = array();

		foreach ($response->feed->entry as $result) {
		
			$detailedarray = array();
			
			if($category=="ebooks"||$category=="iosapps"||$category=="macapps"||$category=="movies"||$category=="music"
					||$category=="musicvideos"||$category=="podcasts"||$category=="tvshows") {
				
				if($category=='iosapps'||$category=="movies"||$category=="music"||$category=="musicvideos") {
					
					if(isset($result->link[0]->attributes->href)) {
					
						$detailedarray['href'] = $result->link[0]->attributes->href;
					}
				}
				
				else if($category=="ebooks"||$category=="macapps"||$category=="podcasts"||$category=="tvshows") {
					
					if(isset($result->link->attributes->href)) {
				
						$detailedarray['href'] = $result->link->attributes->href;
					}
				}
				
				if(isset($result->summary->label)) {
				
					$detailedarray['summary'] = $result->summary->label;
				}
			}
			
			if($category=="audiobooks") {
				if(isset($result->link[0]->attributes->href)) {
			
					$detailedarray['href'] = $result->link[0]->attributes->href;
				}
			}
			
			if(isset($result->title->label)) {
				
				$detailedarray['title'] = $result->title->label;
			}
			
			if(isset($result->{"im:price"}->label)) {
				
				$detailedarray['price'] = $result->{"im:price"}->label;
			}
			
			if(isset($result->{"im:image"}[0]->label)) {
			
				$detailedarray['image'] = $result->{"im:image"}[0]->label;
			}
			
			if(isset($result->{"im:artist"}->label)) {
			
				$detailedarray['artist'] = $result->{"im:artist"}->label;
			}
			
			if(isset($result->{"im:releaseDate"}->attributes->label)) {
			
				$detailedarray['releasedate'] = $result->{"im:releaseDate"}->attributes->label;
			}
			
			array_push($data, $detailedarray);	
		}
		
		return $data;
	}
	
	private function getUrlData($url) {

		$ch = curl_init();
		curl_setopt( $ch, CURLOPT_URL, $url );
		curl_setopt( $ch, CURLOPT_RETURNTRANSFER, true );
		curl_setopt( $ch, CURLOPT_SSL_VERIFYPEER, false );
		curl_setopt( $ch, CURLOPT_CONNECTTIMEOUT, 10 );
		curl_setopt( $ch, CURLOPT_MAXREDIRS, 10 );
		$content = curl_exec( $ch );
		return $content;
	}

} 

